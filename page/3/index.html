<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <title>
    yjm
    
</title>
    <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="browsermode" content="application">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="yjm">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="msapplication-navbutton-color" content="#666666">
<meta name= "format-detection" content="telephone=no" />
<meta name="keywords" content="nlvi, Nlvi" />





<link rel="stylesheet" href="/style/style.css">
<script src="/script/jquery.min.js"></script>
<script>
    var CONFIG = {
        title: "yjm",
        author: "arvin ye",
        lightbox: true,
        animate: true
    }
</script>



    <link rel="stylesheet" href="/lightbox/css/lightbox.min.css">




    <link rel="stylesheet" href="/syuanpi/syuanpi.min.css">









    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</head>
<body>
    <div class="progress">
    <div class="progress-inner"></div>
</div>
    <div class="body">
    <div class="tagcloud-mask"></div>  
<div class="tagcloud" id="tagcloud">
    <div class="tagcloud-inner">
        <a href="/tags/AMD-UMD-CMD-commonJS-ES6-module/" style="font-size: 14px;">AMD - UMD - CMD - commonJS - ES6 module</a> <a href="/tags/CSSOM视图模式/" style="font-size: 14px;">CSSOM视图模式</a> <a href="/tags/ES6解构赋值/" style="font-size: 14px;">ES6解构赋值</a> <a href="/tags/Generator/" style="font-size: 14px;">Generator</a> <a href="/tags/JS执行顺序/" style="font-size: 14px;">JS执行顺序</a> <a href="/tags/Promise/" style="font-size: 14px;">Promise</a> <a href="/tags/apply/" style="font-size: 14px;">apply</a> <a href="/tags/asyn-await/" style="font-size: 14px;">asyn...await</a> <a href="/tags/bind/" style="font-size: 14px;">bind</a> <a href="/tags/call/" style="font-size: 14px;">call</a> <a href="/tags/contenteditable/" style="font-size: 14px;">contenteditable</a> <a href="/tags/echarts/" style="font-size: 14px;">echarts</a> <a href="/tags/interator/" style="font-size: 14px;">interator</a> <a href="/tags/scroll/" style="font-size: 14px;">scroll</a> <a href="/tags/sticky/" style="font-size: 14px;">sticky</a> <a href="/tags/vuex/" style="font-size: 14px;">vuex</a> <a href="/tags/webkit/" style="font-size: 14px;">webkit</a> <a href="/tags/代理/" style="font-size: 14px;">代理</a> <a href="/tags/创建对象/" style="font-size: 14px;">创建对象</a> <a href="/tags/原型链/" style="font-size: 14px;">原型链</a> <a href="/tags/变量声名/" style="font-size: 14px;">变量声名</a> <a href="/tags/回调/" style="font-size: 14px;">回调</a> <a href="/tags/块级作用域/" style="font-size: 14px;">块级作用域</a> <a href="/tags/垂直居中/" style="font-size: 14px;">垂直居中</a> <a href="/tags/层叠水平/" style="font-size: 14px;">层叠水平</a> <a href="/tags/性能/" style="font-size: 14px;">性能</a> <a href="/tags/排序/" style="font-size: 14px;">排序</a> <a href="/tags/数组/" style="font-size: 14px;">数组</a> <a href="/tags/数组遍历/" style="font-size: 14px;">数组遍历</a> <a href="/tags/正则表达式/" style="font-size: 14px;">正则表达式</a> <a href="/tags/线程/" style="font-size: 14px;">线程</a> <a href="/tags/继承-原型链/" style="font-size: 14px;">继承 - 原型链</a> <a href="/tags/轮播/" style="font-size: 14px;">轮播</a> <a href="/tags/闭包/" style="font-size: 14px;">闭包</a> <a href="/tags/隐式转换/" style="font-size: 14px;">隐式转换</a>
    </div>
</div>
    <header class="header" id="header">
    <div class="title syuanpi tvIn">
    <div class="table">
        <div class="connect">
            <div class="connect-inner">
                <span><a href="/">yjm</a></span>
                
            </div>
        </div>
    </div>
</div>
    <nav class="main-nav syuanpi tvIn">
<div class="table">

    <ul class="menu">
        
        <li class="menu-item">
            <a href="javascript:;" id="search">
                <span>搜索</span>
                
                    <span class="menu-item-label">search</span>
                
            </a>
        </li>
        
        
        
            <li class="menu-item">
                <a href="/">
                    <span>文章</span>
                    
                        <span class="menu-item-label">article</span>
                    
                </a>
            </li>
        
        
        
            <li class="menu-item">
                <a href="/archives">
                    <span>归档</span>
                    
                        <span class="menu-item-label">archives</span>
                    
                </a>
            </li>
        
        
        
            <li class="menu-item">
                <a href="javascript:;" id="tags">
                    <span>标签</span>
                    
                        <span class="menu-item-label">tags</span>
                    
                </a>
            </li>
        
        
        
            <li class="menu-item">
                <a href="/about">
                    <span>关于</span>
                    
                        <span class="menu-item-label">about</span>
                    
                </a>
            </li>
        
        
        
            <li class="menu-item">
                <a href="/atom.xml">
                    <span>订阅</span>
                    
                        <span class="menu-item-label">RSS</span>
                    
                </a>
            </li>
        
        
    </ul>

</div>
</nav>
</header>
<div class="mobile-header">
    <div class="mobile-header-body">
        <div class="mobile-header-list">
            
            
                <div class="mobile-nav-item">
                    <a href="/">
                        <span>文章</span>
                        
                            <span class="menu-item-label">article</span>
                        
                    </a>
                </div>
            
            
            
                <div class="mobile-nav-item">
                    <a href="/archives">
                        <span>归档</span>
                        
                            <span class="menu-item-label">archives</span>
                        
                    </a>
                </div>
            
            
            
                <div class="mobile-nav-item inner-cloud">
                    <div class="mobile-nav-tag">
                        <a href="javascript:;" id="mobile-tags">
                            <span>标签</span>
                            
                                <span class="menu-item-label">tags</span>
                            
                        </a>
                    </div>
                    <div class="mobile-nav-tagcloud">
                        <div class="mobile-tagcloud-inner">
                            <a href="/tags/AMD-UMD-CMD-commonJS-ES6-module/" style="font-size: 14px;">AMD - UMD - CMD - commonJS - ES6 module</a> <a href="/tags/CSSOM视图模式/" style="font-size: 14px;">CSSOM视图模式</a> <a href="/tags/ES6解构赋值/" style="font-size: 14px;">ES6解构赋值</a> <a href="/tags/Generator/" style="font-size: 14px;">Generator</a> <a href="/tags/JS执行顺序/" style="font-size: 14px;">JS执行顺序</a> <a href="/tags/Promise/" style="font-size: 14px;">Promise</a> <a href="/tags/apply/" style="font-size: 14px;">apply</a> <a href="/tags/asyn-await/" style="font-size: 14px;">asyn...await</a> <a href="/tags/bind/" style="font-size: 14px;">bind</a> <a href="/tags/call/" style="font-size: 14px;">call</a> <a href="/tags/contenteditable/" style="font-size: 14px;">contenteditable</a> <a href="/tags/echarts/" style="font-size: 14px;">echarts</a> <a href="/tags/interator/" style="font-size: 14px;">interator</a> <a href="/tags/scroll/" style="font-size: 14px;">scroll</a> <a href="/tags/sticky/" style="font-size: 14px;">sticky</a> <a href="/tags/vuex/" style="font-size: 14px;">vuex</a> <a href="/tags/webkit/" style="font-size: 14px;">webkit</a> <a href="/tags/代理/" style="font-size: 14px;">代理</a> <a href="/tags/创建对象/" style="font-size: 14px;">创建对象</a> <a href="/tags/原型链/" style="font-size: 14px;">原型链</a> <a href="/tags/变量声名/" style="font-size: 14px;">变量声名</a> <a href="/tags/回调/" style="font-size: 14px;">回调</a> <a href="/tags/块级作用域/" style="font-size: 14px;">块级作用域</a> <a href="/tags/垂直居中/" style="font-size: 14px;">垂直居中</a> <a href="/tags/层叠水平/" style="font-size: 14px;">层叠水平</a> <a href="/tags/性能/" style="font-size: 14px;">性能</a> <a href="/tags/排序/" style="font-size: 14px;">排序</a> <a href="/tags/数组/" style="font-size: 14px;">数组</a> <a href="/tags/数组遍历/" style="font-size: 14px;">数组遍历</a> <a href="/tags/正则表达式/" style="font-size: 14px;">正则表达式</a> <a href="/tags/线程/" style="font-size: 14px;">线程</a> <a href="/tags/继承-原型链/" style="font-size: 14px;">继承 - 原型链</a> <a href="/tags/轮播/" style="font-size: 14px;">轮播</a> <a href="/tags/闭包/" style="font-size: 14px;">闭包</a> <a href="/tags/隐式转换/" style="font-size: 14px;">隐式转换</a>
                        </div>
                    </div>
                </div>
            
            
            
                <div class="mobile-nav-item">
                    <a href="/about">
                        <span>关于</span>
                        
                            <span class="menu-item-label">about</span>
                        
                    </a>
                </div>
            
            
            
                <div class="mobile-nav-item">
                    <a href="/atom.xml">
                        <span>订阅</span>
                        
                            <span class="menu-item-label">RSS</span>
                        
                    </a>
                </div>
            
            
        </div>
    </div>
    <div class="mobile-header-nav">
        <div class="mobile-header-item" id="mobile-left">
            <div class="header-menu-item">
                <span class="header-menu-line"></span>
            </div>
        </div>
        <h1 class="mobile-header-title">
            <a href="/">yjm</a>
        </h1>
        <div class="mobile-header-item"></div>
    </div>
</div>

    <div class="container">
        <main class="main" id="main">
            
    

<section class="posts">
    
        
    <article class="post">
        <header class="post-header">
            <div class="post-time syuanpi riseIn-light back-1">
                <span>2017年8月22日</span>
                
            </div>
            <h1 class="post-title syuanpi riseIn-light back-2">
            
                <a href="/2017/08/22/JS解决sticky的兼容性问题/">名词汇总JS解决sticky的兼容性问题</a>
            
            </h1>
            
        </header>
        <div class="post-content syuanpi riseIn-light back-3">
            
                
                    <p>在项目中有用到sticky的布局，可是由于兼容性问题，在安卓端没有很好的兼容，所以为了彻底解决这个问题只能写一个组件来解决这个麻烦的问题，这里为什么是组件而不是指令是因为，是有原因的，下面会讲到。</p>
<p>##position:sticky的兼容性以及作用<br>Caniuse上显示sticky的兼容性如下：<br><img src="https://sfault-image.b0.upaiyun.com/209/641/2096419143-59e59f03578b1_articlex" alt=""><br>Sticky的作用相当于relative和fixed的结合体，当修饰的目标节点再屏幕中时表现为relative，当要超出的时候是fixed的形式展现，因为这个特性，我们就可以来实现一个sticky的模拟效果。</p>
<p>##sticky组件实现</p>
<p>####template部分<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sticky"</span> <span class="attr">:style</span>=<span class="string">"getPosition"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"sticky-warp"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><strong>代码解读</strong>：这里我使用了组件来实现，而不用指令来实现的原因是：指令虽然是无侵入性的，更方便使用，可是有一个弊端就是当修饰的节点fixed的时候会脱离文档流，会改变滚动的条的高度，如果仅仅是配合原生滚动条来实现是没问题的（当然这也会存在滚动过快的问题），可是由于是配合自定义滚动所以，采取这种折中的方式来实现。最外层是一个sticky层，判断浏览器是否支持sticky，不支持就使用relative来代替，这样也就不会改变浏览器高度的情况了，然后动态改变stick-warp层的postion来实现效果。</p>
<p>####css部分<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span> <span class="attr">lang</span>=<span class="string">"less"</span> <span class="attr">rel</span>=<span class="string">"stylesheet/less"</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="undefined">    .sticky &#123;</span></div><div class="line"><span class="undefined">        width: 100%;</span></div><div class="line"><span class="undefined">        .sticky-warp &#123;</span></div><div class="line"><span class="undefined">            width: 100%;</span></div><div class="line"><span class="undefined">            background: inherit;</span></div><div class="line"><span class="undefined">            will-change: change;</span></div><div class="line"><span class="undefined">            height: inherit;</span></div><div class="line"><span class="undefined">            top: inherit;</span></div><div class="line"><span class="undefined">        &#125;</span></div><div class="line"><span class="undefined">    &#125;</span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><strong>代码解读</strong>：这里的warp层的背景色设置和sticky一致，这样过渡不会太生硬，高度和top都根据用户对外层sticky的自定义来实现，这样这部分简单用css就可以完成了。</p>
<p>####JS部分</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line">&lt;script type=<span class="string">"text/babel"</span>&gt;</div><div class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">        data () &#123;</div><div class="line">            <span class="keyword">return</span> &#123;&#125;</div><div class="line">        &#125;,</div><div class="line">        computed: &#123;</div><div class="line">            getPosition()&#123;</div><div class="line">                <span class="keyword">var</span> position = <span class="keyword">this</span>.cssSupport(<span class="string">'position'</span>, <span class="string">'sticky'</span>) ? <span class="string">'sticky'</span> : <span class="string">'relative'</span>;</div><div class="line">                <span class="keyword">return</span> <span class="string">'position:'</span> + position;</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        props: &#123;&#125;,</div><div class="line">        beforeMount () &#123;</div><div class="line">        &#125;,</div><div class="line">        mounted()&#123;</div><div class="line">            <span class="keyword">this</span>.init();</div><div class="line">        &#125;,</div><div class="line">        deactivated()&#123;</div><div class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.cssSupport(<span class="string">'position'</span>, <span class="string">'sticky'</span>)) &#123;</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">/*复位*/</span></div><div class="line">            <span class="keyword">var</span> elWarp = <span class="keyword">this</span>.$el.querySelector(<span class="string">'.sticky-warp'</span>);</div><div class="line">            elWarp.position = <span class="string">'absolute'</span>;</div><div class="line">        &#125;,</div><div class="line">        methods: &#123;</div><div class="line">            init()&#123;</div><div class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>.cssSupport(<span class="string">'position'</span>, <span class="string">'sticky'</span>)) &#123;</div><div class="line">                    <span class="keyword">return</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">var</span> el = <span class="keyword">this</span>.$el, target = <span class="keyword">this</span>.$el.parentNode,</div><div class="line">                        elWarp = <span class="keyword">this</span>.$el.querySelector(<span class="string">'.sticky-warp'</span>),</div><div class="line">                        top = <span class="keyword">this</span>.getNumberValue(<span class="built_in">document</span>.defaultView.getComputedStyle(el).top);</div><div class="line">                <span class="keyword">this</span>.addScrollListen(target, (event)=&gt; &#123;</div><div class="line">                    <span class="keyword">if</span> (el.getBoundingClientRect().top &lt;= top) &#123;</div><div class="line">                        elWarp.style.position = <span class="string">'fixed'</span>;</div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">if</span> (el.getBoundingClientRect().top &gt;= <span class="number">0</span> &amp;&amp; elWarp.style.position != <span class="string">'absolute'</span>) &#123;</div><div class="line">                        elWarp.style.position = <span class="string">'absolute'</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;)</div><div class="line">            &#125;,</div><div class="line">            cssSupport: <span class="function"><span class="keyword">function</span> (<span class="params">attr, value</span>) </span>&#123;</div><div class="line">                <span class="keyword">var</span> element = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</div><div class="line">                <span class="keyword">if</span> (attr <span class="keyword">in</span> element.style) &#123;</div><div class="line">                    element.style[attr] = value;</div><div class="line">                    <span class="keyword">return</span> element.style[attr] === value;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;,</div><div class="line">            getNumberValue(pxValue)&#123;</div><div class="line">                <span class="keyword">var</span> value = <span class="built_in">String</span>(pxValue).match(<span class="regexp">/^\-?\+?[0-9]+/g</span>);</div><div class="line">                <span class="keyword">return</span> value ? <span class="built_in">Number</span>(value) : <span class="literal">undefined</span>;</div><div class="line">            &#125;,</div><div class="line">            addScrollListen(target, cb)&#123;</div><div class="line">                target.addEventListener(<span class="string">'y-scroll'</span>, (event)=&gt; &#123;</div><div class="line">                    cb &amp;&amp; cb(event);</div><div class="line">                &#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<p><strong>代码解读</strong>：这里面主要先用cssSupport来判断一下浏览器的支持情况，然后通过多自定义滚动y-scroll事件的监听，监听top值的改变来实现sticky-warp层的fixed和absolute的转换。大概原理的思路及实现过程就是上面这样，对于自定义的滚动的github地址：<a href="https://github.com/yejiaming/scroll" target="_blank" rel="external">https://github.com/yejiaming/scroll</a>，sticky组件以及原生滚动下的指令参考的实现的github地址如下：<a href="https://github.com/yejiaming/sticky" target="_blank" rel="external">https://github.com/yejiaming/sticky</a></p>

                
            
        
        </div>
        
    </article>
    

    
        
    <article class="post">
        <header class="post-header">
            <div class="post-time syuanpi riseIn-light back-1">
                <span>2017年8月22日</span>
                
            </div>
            <h1 class="post-title syuanpi riseIn-light back-2">
            
                <a href="/2017/08/22/使用contenteditable+div模拟textarea文本域实现高度自适应/">使用contenteditable+div模拟textarea文本域实现高度自适应</a>
            
            </h1>
            
        </header>
        <div class="post-content syuanpi riseIn-light back-3">
            
                
                    <p>开发过程中由于需要在发送消息的时候需要有一个可以高度自适应的文本域，一开始是使用textarea并搭配auto-size插件来做到textarea的高度自适应，后来因为遇到一些问题，而且也多加了依赖缺乏可定制，所以决定使用contenteditable来实现。</p>
<h2 id="contenteditable介绍"><a href="#contenteditable介绍" class="headerlink" title="contenteditable介绍"></a>contenteditable介绍</h2><p><strong>contenteditable</strong>属性规定元素内容是否可编辑，是H5新增的属性，支持情况相当好，基本上所有的浏览器都兼容。</p>
<p><strong>语法：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">element</span> <span class="attr">contenteditable</span>=<span class="string">"true|false"</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="实现主要代码如下"><a href="#实现主要代码如下" class="headerlink" title="实现主要代码如下"></a>实现主要代码如下</h2><p>代码实现是基于vue来实现的。<br><strong>html部分：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"textarea"</span> <span class="attr">contenteditable</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure>
<p><strong>CSS部分</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&lt;style scoped lang="less" rel="stylesheet/less"&gt;</div><div class="line">    <span class="selector-class">.textarea</span> &#123;</div><div class="line">        <span class="attribute">box-sizing</span>: border-box;</div><div class="line">        <span class="attribute">min-height</span>: <span class="number">136px</span>;</div><div class="line">        <span class="attribute">max-height</span>: <span class="number">300px</span>;</div><div class="line">        <span class="attribute">margin-left</span>: auto;</div><div class="line">        <span class="attribute">margin-right</span>: auto;</div><div class="line">        <span class="attribute">padding</span>: <span class="number">3px</span>;</div><div class="line">        <span class="attribute">outline</span>: <span class="number">0</span>;</div><div class="line">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#a0b3d6</span>;</div><div class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span>;</div><div class="line">        <span class="attribute">word-wrap</span>: break-word;</div><div class="line">        <span class="attribute">overflow-x</span>: hidden;</div><div class="line">        <span class="attribute">overflow-y</span>: auto;</div><div class="line">        <span class="attribute">_overflow-y</span>: visible;</div><div class="line">        -webkit-user-modify: read-write-plaintext-only; // 只是编辑text文本，只能解决webkit内核里面问题，手机端适用</div><div class="line">        -webkit-user-select: text; // 解决IOS部分手机不支持contenteditable=true属性问题</div><div class="line">        <span class="selector-tag">p</span> &#123;</div><div class="line">            <span class="attribute">margin</span>: <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&lt;/style&gt;</div></pre></td></tr></table></figure>
<p><strong>代码解读：</strong></p>
<ul>
<li>设置-webkit-user-modify属性，是为了在剪切复制的时候会把剪切的内容的格式也一并带过来，由于我们是仿写textarea，是不支持富文本的，所以需要需要将内容格式化成文本格式，而该属性在webkit内核下就可以达到我们的目的。</li>
<li>设置-webkit-user-select属性，是为了解决在测试过程中出现部分IOS手机不支持contenteditable属性的问题。</li>
</ul>
<p><strong>JS部分：</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div></pre></td><td class="code"><pre><div class="line">&lt;script type=<span class="string">"text/babel"</span>&gt;</div><div class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">        mounted() &#123;</div><div class="line">            <span class="keyword">this</span>.addInputEvent();</div><div class="line">            <span class="keyword">this</span>.addFocusEvent();</div><div class="line">            <span class="keyword">this</span>.addEventPaste(<span class="keyword">this</span>.$el);</div><div class="line">        &#125;,</div><div class="line">        methods: &#123;</div><div class="line">            <span class="comment">/**</span></div><div class="line"><span class="comment">             * 监听鼠标input事件</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            addInputEvent()&#123;</div><div class="line">                <span class="keyword">this</span>.$el.addEventListener(<span class="string">'input'</span>, () =&gt; &#123;</div><div class="line">                    <span class="keyword">this</span>.$emit(<span class="string">'input'</span>, <span class="keyword">this</span>.getValue());</div><div class="line">                &#125;)</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">/**</span></div><div class="line"><span class="comment">             * 监听鼠标获取焦点事件</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            addFocusEvent()&#123;</div><div class="line">                <span class="keyword">this</span>.$el.addEventListener(<span class="string">'focus'</span>, () =&gt; &#123;</div><div class="line">                    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">                        <span class="comment">// 解决：如果ios手机使用的不是原生键盘（也可能不止IOS手机有这个问题），则会出现键盘挡住输入框问题，当bottom=0的情况，使用这个属性就可以滚动屏幕中央</span></div><div class="line">                        <span class="keyword">this</span>.$el.scrollIntoView(<span class="literal">true</span>);</div><div class="line">                    &#125;, <span class="number">300</span>);</div><div class="line">                    <span class="keyword">this</span>.$emit(<span class="string">'focus'</span>);</div><div class="line">                &#125;)</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">/**</span></div><div class="line"><span class="comment">             * 追加</span></div><div class="line"><span class="comment">             * @param value</span></div><div class="line"><span class="comment">             * @param bool</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            appendValue(value, bool) &#123;</div><div class="line">                <span class="keyword">this</span>.$el.innerText += value;</div><div class="line">                <span class="keyword">this</span>.$emit(<span class="string">'input'</span>, <span class="keyword">this</span>.getValue());</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">/**</span></div><div class="line"><span class="comment">             * 监听复制事件，去除样式得到纯文本</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            addEventPaste: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;</div><div class="line">                <span class="comment">// 干掉IE http之类地址自动加链接</span></div><div class="line">                <span class="keyword">try</span> &#123;</div><div class="line">                    <span class="built_in">document</span>.execCommand(<span class="string">"AutoUrlDetect"</span>, <span class="literal">false</span>, <span class="literal">false</span>);</div><div class="line">                &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">                &#125;</div><div class="line">                <span class="comment">// 监听复制paste事件，目的是为了让-webkit-user-modify属性兼容IE8，毕竟该属性在IE兼容性不好</span></div><div class="line">                el.addEventListener(<span class="string">'paste'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">                    e.preventDefault();</div><div class="line">                    <span class="keyword">var</span> text = <span class="literal">null</span>;</div><div class="line">                    <span class="keyword">if</span> (<span class="built_in">window</span>.clipboardData &amp;&amp; clipboardData.setData) &#123;</div><div class="line">                        <span class="comment">// IE</span></div><div class="line">                        text = <span class="built_in">window</span>.clipboardData.getData(<span class="string">'text'</span>);</div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        text = (e.originalEvent || e).clipboardData.getData(<span class="string">'text/plain'</span>) || prompt(<span class="string">'在这里输入文本'</span>);</div><div class="line">                    &#125;</div><div class="line">                    <span class="comment">// 这里的目的是为了将鼠标的光标移动到复制之后文本的末尾的末尾</span></div><div class="line">                    <span class="keyword">if</span> (<span class="built_in">document</span>.body.createTextRange) &#123;</div><div class="line">                        <span class="keyword">if</span> (<span class="built_in">document</span>.selection) &#123;</div><div class="line">                            textRange = <span class="built_in">document</span>.selection.createRange();</div><div class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">window</span>.getSelection) &#123;</div><div class="line">                            sel = <span class="built_in">window</span>.getSelection();</div><div class="line">                            <span class="keyword">var</span> range = sel.getRangeAt(<span class="number">0</span>);</div><div class="line">                            <span class="comment">// 创建临时元素，使得TextRange可以移动到正确的位置</span></div><div class="line">                            <span class="keyword">var</span> tempEl = <span class="built_in">document</span>.createElement(<span class="string">"span"</span>);</div><div class="line">                            tempEl.innerHTML = <span class="string">"&amp;#FEFF;"</span>;</div><div class="line">                            range.deleteContents();</div><div class="line">                            range.insertNode(tempEl);</div><div class="line">                            textRange = <span class="built_in">document</span>.body.createTextRange();</div><div class="line">                            textRange.moveToElementText(tempEl);</div><div class="line">                            tempEl.parentNode.removeChild(tempEl);</div><div class="line">                        &#125;</div><div class="line">                        textRange.text = text;</div><div class="line">                        textRange.collapse(<span class="literal">false</span>);</div><div class="line">                        textRange.select();</div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        <span class="comment">// Chrome之类浏览器</span></div><div class="line">                        <span class="built_in">document</span>.execCommand(<span class="string">"insertText"</span>, <span class="literal">false</span>, text);</div><div class="line">                    &#125;</div><div class="line">                &#125;);</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">/**</span></div><div class="line"><span class="comment">             * 替换</span></div><div class="line"><span class="comment">             * @param value</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            setValue(value) &#123;</div><div class="line">                <span class="keyword">this</span>.$el.innerText = value;</div><div class="line">                <span class="keyword">this</span>.$emit(<span class="string">'input'</span>, <span class="keyword">this</span>.getValue());</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">/**</span></div><div class="line"><span class="comment">             * 获取值</span></div><div class="line"><span class="comment">             * @returns &#123;*&#125;</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            getValue() &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.getHtmlToText();</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">/**</span></div><div class="line"><span class="comment">             * 获取HTML转换之后的文本（去除div标签，替换&lt;br/&gt;为换行）</span></div><div class="line"><span class="comment">             * @returns &#123;string&#125;</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            getHtmlToText() &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.replaceToBreak(<span class="keyword">this</span>.getHtml());</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">/**</span></div><div class="line"><span class="comment">             * 获取HTML</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            getHtml() &#123;</div><div class="line">                <span class="keyword">return</span> <span class="built_in">document</span>.querySelector(<span class="string">'.textarea'</span>).innerHTML</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">/**</span></div><div class="line"><span class="comment">             * 替换DIV到换行符</span></div><div class="line"><span class="comment">             * @returns &#123;string&#125;</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            replaceToBreak(html) &#123;</div><div class="line">                html = <span class="built_in">String</span>(html).replace(<span class="regexp">/&lt;\/div&gt;/gi</span>, <span class="string">''</span>);</div><div class="line">                html = html.replace(<span class="regexp">/&lt;div&gt;(&lt;br&gt;)?(&lt;br\/&gt;)?/gi</span>, <span class="string">'\n'</span>);</div><div class="line">                html = html.replace(<span class="regexp">/&lt;br&gt;|&lt;br\/&gt;/gi</span>, <span class="string">'\n'</span>);</div><div class="line">                <span class="keyword">return</span> html;</div><div class="line">            &#125;,</div><div class="line">            <span class="comment">/**</span></div><div class="line"><span class="comment">             * 获取纯text文本</span></div><div class="line"><span class="comment">             * @returns &#123;string&#125;</span></div><div class="line"><span class="comment">             */</span></div><div class="line">            getText()&#123;</div><div class="line">                <span class="keyword">if</span> (<span class="built_in">window</span>.navigator.appName.indexOf(<span class="string">"Explorer"</span>) &gt; <span class="number">-1</span>)</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">this</span>.$el.innerText;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                    <span class="keyword">return</span> <span class="keyword">this</span>.$el.textContent;</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">    &#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure>
<p><strong>代码解读：</strong></p>
<ul>
<li>其中<strong>addEventPaste</strong>方法是为了解决非webkit内核对于<strong>-webkit-user-select</strong>属性支持不好的问题。里面主要是监听黏贴事件然后或者剪切板的文本内容然后再阻止黏贴事件，并将文本内容追加到光标中，并将光标移动到相应的位置。</li>
<li>其中<strong>replaceToBreak</strong>方法是为了解决在textarea中换行的问题，在该伪textarea中换行是会单独将换行内容放到新的DIV中的，所以，当我们需要对该内容进行格式化处理才行。</li>
<li><strong>this.$el.scrollIntoView</strong>的作用是为了当使用者将我们的输入框是使用绝对定位放在页面底部的时候而被虚拟键盘遮挡的问题。</li>
</ul>
<h2 id="issue"><a href="#issue" class="headerlink" title="issue"></a>issue</h2><ul>
<li>使用该组件注意一个问题就是不要在可视化区域的节点上使用-<strong>webkit-user-select: none</strong>样式，否则会出现当鼠标焦点小时光标和小水滴无法消失的情况</li>
</ul>
<h2 id="github地址"><a href="#github地址" class="headerlink" title="github地址"></a>github地址</h2><p><a href="https://github.com/yejiaming/textarea/tree/master" target="_blank" rel="external">github项目地址</a></p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="http://www.zhangxinxu.com/wordpress/2010/12/div-textarea-height-auto/" target="_blank" rel="external">div模拟textarea文本域轻松实现高度自适应</a><br><a href="http://www.zhangxinxu.com/wordpress/2016/01/contenteditable-plaintext-only/" target="_blank" rel="external">如何让contenteditable元素只能输入纯文本</a></p>

                
            
        
        </div>
        
    </article>
    

    
        
    <article class="post">
        <header class="post-header">
            <div class="post-time syuanpi riseIn-light back-1">
                <span>2017年8月22日</span>
                
            </div>
            <h1 class="post-title syuanpi riseIn-light back-2">
            
                <a href="/2017/08/22/关于top、left结合translate实现居中的原理探讨/">关于top、left结合translate实现居中的原理探讨</a>
            
            </h1>
            
        </header>
        <div class="post-content syuanpi riseIn-light back-3">
            
                
                    <h2 id="前情提要"><a href="#前情提要" class="headerlink" title="前情提要"></a>前情提要</h2><ul>
<li>在居中对齐的方法中常用的一种方法之一，就是使用绝对定位结合 translate、top、left实现居中，探讨原理之前先来看一下实现代码和实现效果：</li>
</ul>
<p></p><p data-height="300" data-theme-id="32624" data-slug-hash="paZEVz" data-default-tab="css,result" data-user="yejiaming" data-embed-version="2" data-pen-title="paZEVz" class="codepen">See the Pen <a href="https://codepen.io/yejiaming/pen/paZEVz/" target="_blank" rel="external">paZEVz</a> by yeArvin (<a href="https://codepen.io/yejiaming" target="_blank" rel="external">@yejiaming</a>) on <a href="https://codepen.io" target="_blank" rel="external">CodePen</a>.</p><p></p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

<ul>
<li>上面的实现效果最主要的代码如下：</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.out</span> &#123;</div><div class="line">  <span class="attribute">position</span>: relative;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.in</span> &#123;</div><div class="line">  <span class="attribute">position</span>: absolute;</div><div class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</div><div class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</div><div class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-50%, -50%);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>解读：</em>由此可见主要是由top、left的百分比和translate百分比实现的，那我们接下来就有必要讲一下两者百分比的原理了：</p>
<h3 id="top、left的百分比的原理"><a href="#top、left的百分比的原理" class="headerlink" title="top、left的百分比的原理"></a>top、left的百分比的原理</h3><ul>
<li>从上述的代码和效果中可以看出，居中对齐的实现是依靠了<strong>top/left</strong>的的百分比来实现的，而且还是<strong>正</strong>的百分比，下面我们先给出其百分比和位置的公式：</li>
</ul>
<blockquote>
<p>X（内X轴偏移量） = width（外） <em> left百分比（内）<br>  Y（内Y轴偏移量） = height（外） </em> top百分比（内）</p>
</blockquote>
<ul>
<li>演示：</li>
</ul>
<p></p><p data-height="300" data-theme-id="32624" data-slug-hash="WMKxVK" data-default-tab="css,result" data-user="yejiaming" data-embed-version="2" data-pen-title="WMKxVK" class="codepen">See the Pen <a href="https://codepen.io/yejiaming/pen/WMKxVK/" target="_blank" rel="external">WMKxVK</a> by yeArvin (<a href="https://codepen.io/yejiaming" target="_blank" rel="external">@yejiaming</a>) on <a href="https://codepen.io" target="_blank" rel="external">CodePen</a>.</p><p></p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

<h3 id="translate的百分比的原理"><a href="#translate的百分比的原理" class="headerlink" title="translate的百分比的原理"></a>translate的百分比的原理</h3><ul>
<li>从上述的代码和效果中可以看出，居中对齐的实现是还依靠了<strong>translate</strong>，而且还是负的百分比，下面我们先给出它百分比和位置的公式：</li>
</ul>
<blockquote>
<p>X（内X轴偏移量） = width（内） <em> translateX百分比（内）<br>  Y（内Y轴偏移量） = height（内） </em> translateY百分比（内）</p>
</blockquote>
<ul>
<li>演示</li>
</ul>
<p></p><p data-height="300" data-theme-id="32624" data-slug-hash="XZBKeO" data-default-tab="css,result" data-user="yejiaming" data-embed-version="2" data-pen-title="XZBKeO" class="codepen">See the Pen <a href="https://codepen.io/yejiaming/pen/XZBKeO/" target="_blank" rel="external">XZBKeO</a> by yeArvin (<a href="https://codepen.io/yejiaming" target="_blank" rel="external">@yejiaming</a>) on <a href="https://codepen.io" target="_blank" rel="external">CodePen</a>.</p><p></p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>从上述的原理解读中可以看出最终的位置的计算公式是：</p>
<blockquote>
<p>X（内X轴偏移量） = width（外） <em> left百分比（内） + width（内） </em> translateX百分比（内）<br>  Y（内Y轴偏移量） = height（外） <em> top百分比（内） + height（内） </em> translateY百分比（内）</p>
</blockquote>
<p><strong>即：</strong></p>
<blockquote>
<p>X（内X轴偏移量） = 300 <em> 50% + 100 </em> -50% = 100<br>Y（内X轴偏移量） = 300 <em> 50% + 100 </em> -50% = 100</p>
</blockquote>

                
            
        
        </div>
        
    </article>
    

    
        
    <article class="post">
        <header class="post-header">
            <div class="post-time syuanpi riseIn-light back-1">
                <span>2017年8月22日</span>
                
            </div>
            <h1 class="post-title syuanpi riseIn-light back-2">
            
                <a href="/2017/08/22/前端性能优化/">前端性能优化</a>
            
            </h1>
            
        </header>
        <div class="post-content syuanpi riseIn-light back-3">
            
                
                    <h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><ul>
<li>1）减少HTTP请求，合并压缩JS和CSS文件；</li>
<li>2）避免重定向；</li>
</ul>
<h2 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h2><ul>
<li>1）合理使用域名收敛和域名扩散，在减少DNS解析次数的同时，增大浏览器对同域名的连接数；</li>
<li>2）在首页合理使用 DNS 预解析；</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"x-dns-prefetch-control"</span> <span class="attr">content</span>=<span class="string">"on"</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--以下就是可以预解析的域名了--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">"//www.itechzero.com"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">"//api.share.baidu.com"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">"//bdimg.share.baidu.com"</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h2><ul>
<li>1）使用CDN；</li>
<li>2）添加合理的Expires或Cache-Control响应头，配置 ETag；</li>
<li>3）开启gzip压缩；</li>
</ul>
<h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><ul>
<li>1）避免空 src，因为会影响 DOMContentLoaded 和 Loaded；</li>
<li>2）尽量不要使用 iframe；</li>
<li>3）按需加载和预加载 JS 和 CSS；</li>
</ul>
<h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><ul>
<li>1）CSS精灵；</li>
<li>2）使用 link 代替 @import；</li>
<li>3）不适用 CSS 表达式；</li>
<li>4）将样式表放到页面顶部去加载；</li>
<li>5）合理使用媒体查询按需加载CSS；</li>
</ul>
<h2 id="JS"><a href="#JS" class="headerlink" title="JS"></a>JS</h2><ul>
<li>1）将脚本放到页面底部加载；</li>
<li>2）如果是首页的关键性的脚本，建议内联，其他的建议外部引用的方式；</li>
<li>3）按需加载需要的脚本；</li>
<li>5）使用事件代理，减少事件监听；</li>
<li>6）减少 DOM 访问，操作样式尽量针对 class 不要直接改变 style，如果一次性 DOM 操作节点过多的话建议使用 DocumentFragment 加快DOM渲染速度；</li>
<li>7）动画效果的实现尽量使用 transform 属性代替其他的属性，因为 transform 不会触发重排操作；</li>
</ul>
<h2 id="img"><a href="#img" class="headerlink" title="img"></a>img</h2><ul>
<li>1）不要拉伸图片，保持 1：1 的比例就可以；</li>
<li>2）保证 favicon.ico 小并且可缓存；</li>
<li>3）进行图片压缩；</li>
</ul>

                
            
        
        </div>
        
    </article>
    

    
        
    <article class="post">
        <header class="post-header">
            <div class="post-time syuanpi riseIn-light back-1">
                <span>2017年8月22日</span>
                
            </div>
            <h1 class="post-title syuanpi riseIn-light back-2">
            
                <a href="/2017/08/22/CSSOM视图模式(CSSOM View Module)/">CSSOM视图模式(CSSOM View Module)</a>
            
            </h1>
            
        </header>
        <div class="post-content syuanpi riseIn-light back-3">
            
                
                    <p>[TOC]</p>
<h2 id="Window视图属性"><a href="#Window视图属性" class="headerlink" title="Window视图属性"></a>Window视图属性</h2><h3 id="innerWidth-和-innerHeight"><a href="#innerWidth-和-innerHeight" class="headerlink" title="innerWidth 和 innerHeight"></a><code>innerWidth</code> 和 <code>innerHeight</code></h3><ul>
<li>这两个属性 表示获取window窗体的内部宽度和高度，不包括用户界面元素，比如任务栏、窗框等。</li>
<li>兼容性：<img src="media/15105440971653/15121111242239.jpg" alt=""></li>
</ul>
<h3 id="outerWidth和outerHeight"><a href="#outerWidth和outerHeight" class="headerlink" title="outerWidth和outerHeight"></a><code>outerWidth</code>和<code>outerHeight</code></h3><ul>
<li>outerWidth/outerHeight表示整个浏览器窗体的大小，包括任务栏、窗框等。</li>
<li>兼容性：<img src="media/15105440971653/15121112115549.jpg" alt=""></li>
</ul>
<h3 id="pageXOffset和pageYOffset"><a href="#pageXOffset和pageYOffset" class="headerlink" title="pageXOffset和pageYOffset"></a><code>pageXOffset</code>和<code>pageYOffset</code></h3><ul>
<li>表示整个页面滚动条卷去部分的滚动像素值（水平方向的和垂直方向的），和scrollTop作用是一样的，但不同的是他们的属性是只读的。</li>
<li>兼容性：<img src="media/15105440971653/15121112689246.jpg" alt=""></li>
</ul>
<h3 id="screenX-和-screenY"><a href="#screenX-和-screenY" class="headerlink" title="screenX 和 screenY"></a><code>screenX</code> 和 <code>screenY</code></h3><ul>
<li>浏览器窗口在显示器中的位置，screenX表示水平位置，screenY表示垂直位置。该属性兼容性如下表：</li>
<li>兼容性：<img src="media/15105440971653/15121122362235.jpg" alt=""></li>
</ul>
<h2 id="Screen视图属性"><a href="#Screen视图属性" class="headerlink" title="Screen视图属性"></a>Screen视图属性</h2><h3 id="availWidth和availHeight"><a href="#availWidth和availHeight" class="headerlink" title="availWidth和availHeight"></a><code>availWidth</code>和<code>availHeight</code></h3><ul>
<li>表示显示器可用宽高，不包括任务栏、窗框等。</li>
<li>兼容性：<img src="media/15105440971653/15121123533818.jpg" alt=""></li>
</ul>
<h3 id="colorDepth"><a href="#colorDepth" class="headerlink" title="colorDepth"></a><code>colorDepth</code></h3><ul>
<li>表示显示器的颜色深度。</li>
<li><p>兼容性：<br><img src="media/15105440971653/15121124668943.jpg" alt=""></p>
</li>
<li><p>应用</p>
</li>
<li><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 在8比特屏显示交替的背景颜色：</span></div><div class="line"><span class="keyword">if</span> (screen.colorDepth&lt;=<span class="number">8</span>)</div><div class="line">    <span class="comment">//为8位屏幕的简单的蓝色背景色</span></div><div class="line">    <span class="built_in">document</span>.body.style.background=<span class="string">"#0000FF"</span></div><div class="line"><span class="keyword">else</span></div><div class="line">    <span class="comment">//为现代屏幕的华丽的蓝色背景色</span></div><div class="line">    <span class="built_in">document</span>.body.style.background=<span class="string">"#87CEFA"</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="pixelDepth"><a href="#pixelDepth" class="headerlink" title="pixelDepth"></a><code>pixelDepth</code></h3><ul>
<li>该属性基本上与colorDepth一样。</li>
<li>兼容性：<img src="media/15105440971653/15121128310463.jpg" alt=""></li>
</ul>
<h3 id="width和height"><a href="#width和height" class="headerlink" title="width和height"></a><code>width</code>和<code>height</code></h3><ul>
<li>表示显示器屏幕的宽高，包括任务栏、窗框等。</li>
<li>兼容性：<img src="media/15105440971653/15121128869970.jpg" alt=""></li>
</ul>
<h2 id="文档视图-DocumentView-和元素视图-ElementView-方法"><a href="#文档视图-DocumentView-和元素视图-ElementView-方法" class="headerlink" title="文档视图(DocumentView)和元素视图(ElementView)方法"></a>文档视图(<code>DocumentView</code>)和元素视图(<code>ElementView</code>)方法</h2><h3 id="elementFromPoint"><a href="#elementFromPoint" class="headerlink" title="elementFromPoint()"></a><code>elementFromPoint()</code></h3><ul>
<li>返回给定坐标处所在的元素。</li>
<li>兼容性：<img src="media/15105440971653/15121131566318.jpg" alt=""></li>
</ul>
<h3 id="getBoundingClientRect"><a href="#getBoundingClientRect" class="headerlink" title="getBoundingClientRect()"></a><code>getBoundingClientRect()</code></h3><ul>
<li>得到矩形元素的界线，返回的是一个对象，包含 top, left, right, 和 bottom四个属性值，大小都是相对于文档视图左上角计算而来。返回内容类似于：</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    top: <span class="number">143</span>,</div><div class="line">    right: <span class="number">1196</span>,</div><div class="line">    bottom: <span class="number">164</span>,</div><div class="line">    left: <span class="number">889</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>兼容性：<img src="media/15105440971653/15121133163097.jpg" alt=""></li>
</ul>
<h3 id="getClientRects"><a href="#getClientRects" class="headerlink" title="getClientRects()"></a><code>getClientRects()</code></h3><ul>
<li>返回元素的数个矩形区域，返回的结果是个对象列表，具有数组特性。这里的矩形选区只针对inline box，因此，只针对a, span, em这类标签元素。</li>
<li><a href="http://www.zhangxinxu.com/study/201109/get-client-rects.html" target="_blank" rel="external">demo</a></li>
<li>兼容性：<img src="media/15105440971653/15121134341115.jpg" alt=""></li>
<li>应用：可以计算从服务器返回的数据会在不同的浏览器或者手机上(IE6/IE7除外)内容占的行数。</li>
</ul>
<h3 id="scrollIntoView"><a href="#scrollIntoView" class="headerlink" title="scrollIntoView()"></a><code>scrollIntoView()</code></h3><ul>
<li>让元素滚动到可视区域（不属于草案方法）。</li>
<li>兼容性：<img src="media/15105440971653/15121140405192.jpg" alt=""></li>
<li>应用：实现元素的锚点跳转功能的另外一条途径。</li>
</ul>
<h2 id="元素视图属性"><a href="#元素视图属性" class="headerlink" title="元素视图属性"></a>元素视图属性</h2><h3 id="clientLeft和clientTop"><a href="#clientLeft和clientTop" class="headerlink" title="clientLeft和clientTop"></a><code>clientLeft</code>和<code>clientTop</code></h3><ul>
<li>表示内容区域（不包括padding）的左上角相对于整个元素左上角的位置（包括边框，或者说近似等于边框border的值）。</li>
<li>兼容性：<img src="media/15105440971653/15121144544400.jpg" alt=""></li>
</ul>
<h3 id="clientWidth和clientHeight"><a href="#clientWidth和clientHeight" class="headerlink" title="clientWidth和clientHeight"></a><code>clientWidth</code>和<code>clientHeight</code></h3><ul>
<li>表示内容区域的高度和宽度，包括padding大小，但是不包括边框和滚动条。</li>
<li>兼容性：<img src="media/15105440971653/15121147949919.jpg" alt=""></li>
</ul>
<h3 id="offsetWidth和offsetHeight"><a href="#offsetWidth和offsetHeight" class="headerlink" title="offsetWidth和offsetHeight"></a><code>offsetWidth</code>和<code>offsetHeight</code></h3><ul>
<li>表示内容区域的高度和宽度，包括padding大小，包括边框。</li>
<li>兼容性：<img src="media/15105440971653/15121150524848.jpg" alt=""></li>
</ul>
<h3 id="offsetLeft和offsetTop"><a href="#offsetLeft和offsetTop" class="headerlink" title="offsetLeft和offsetTop"></a><code>offsetLeft</code>和<code>offsetTop</code></h3><ul>
<li>表示相对于最近的祖先定位元素（CSS position 属性被设置为 relative、absolute 或 fixed 的元素）的左右偏移值。</li>
<li>兼容性：<img src="media/15105440971653/15121148494839.jpg" alt=""></li>
</ul>
<h3 id="offsetParent"><a href="#offsetParent" class="headerlink" title="offsetParent"></a><code>offsetParent</code></h3><ul>
<li>第一个祖定位元素（即用来计算上面的<code>offsetLeft</code>和<code>offsetTop</code>的元素）。</li>
<li>兼容性：<img src="media/15105440971653/15121149242845.jpg" alt=""></li>
<li>另外，在IE和Opera浏览器下，<code>position: fixed</code>的元素没有<code>offsetParent</code>，<code>body</code>元素为定位元素的终极元素，所以其上头就没有其他定位元素了。</li>
</ul>
<h3 id="scrollLeft和scrollTop"><a href="#scrollLeft和scrollTop" class="headerlink" title="scrollLeft和scrollTop"></a><code>scrollLeft</code>和<code>scrollTop</code></h3><ul>
<li>表示元素滚动的像素大小。可读可写。</li>
<li>兼容性：<img src="media/15105440971653/15121151866827.jpg" alt=""></li>
</ul>
<h3 id="scrollWidth和scrollHeight"><a href="#scrollWidth和scrollHeight" class="headerlink" title="scrollWidth和scrollHeight"></a><code>scrollWidth</code>和<code>scrollHeight</code></h3><ul>
<li>表示整个内容区域的宽高，包括隐藏的部分。如果元素没有隐藏的部分，则相关的值应该等用于<code>clientWidth</code>和<code>clientHeight</code>。当你向下滚动滚动条的时候，<code>scrollHeight</code>应该等用于<code>scrollTop</code> + <code>clientHeight</code>。</li>
<li>兼容性：<img src="media/15105440971653/15121152881814.jpg" alt=""></li>
</ul>
<h2 id="鼠标位置-Mouse-position"><a href="#鼠标位置-Mouse-position" class="headerlink" title="鼠标位置(Mouse position)"></a>鼠标位置(Mouse position)</h2><h3 id="clientX和clientY"><a href="#clientX和clientY" class="headerlink" title="clientX和clientY"></a><code>clientX</code>和<code>clientY</code></h3><ul>
<li>相对于window，为鼠标相对于window的偏移。在iphone上，这对值返回的位置就等同于下面要提到的<code>pageX/Y</code>。</li>
<li>兼容性：<img src="media/15105440971653/15121153792617.jpg" alt=""></li>
</ul>
<h3 id="offsetX-和-offsetY"><a href="#offsetX-和-offsetY" class="headerlink" title="offsetX 和 offsetY"></a><code>offsetX</code> 和 <code>offsetY</code></h3><ul>
<li>表示鼠标相对于当前被点击元素padding box的左上偏移值。</li>
<li>兼容性：<img src="media/15105440971653/15121154190075.jpg" alt=""></li>
<li>在IE7以及以下浏览器下，只有当当前目标元素为offsetParent是才计算坐标值，否则，它就会拿当前目标元素的offsetParent来计算。还有，当发现元素应用了position: relative后，IE会去寻找下一个offsetParent来计算offsetY，但又不是offsetX。</li>
</ul>
<h3 id="pageX-和-pageY"><a href="#pageX-和-pageY" class="headerlink" title="pageX 和 pageY"></a><code>pageX</code> 和 <code>pageY</code></h3><ul>
<li>为鼠标相对于document的坐标。</li>
<li>兼容性：<img src="media/15105440971653/15121154992359.jpg" alt=""></li>
</ul>
<h3 id="screenX-和-screenY-1"><a href="#screenX-和-screenY-1" class="headerlink" title="screenX 和 screenY"></a><code>screenX</code> 和 <code>screenY</code></h3><ul>
<li>鼠标相对于显示器屏幕的偏移坐标。</li>
<li>兼容性：<img src="media/15105440971653/15121155406803.jpg" alt=""></li>
</ul>
<h3 id="x-和-y"><a href="#x-和-y" class="headerlink" title="x 和 y"></a><code>x</code> 和 <code>y</code></h3><ul>
<li>相当于clientX/clientY。</li>
<li>兼容性：<img src="media/15105440971653/15121155893074.jpg" alt=""></li>
</ul>

                
            
        
        </div>
        
    </article>
    

    
        
    <article class="post">
        <header class="post-header">
            <div class="post-time syuanpi riseIn-light back-1">
                <span>2017年8月22日</span>
                
            </div>
            <h1 class="post-title syuanpi riseIn-light back-2">
            
                <a href="/2017/08/22/echarts 问题记录和解决方案/">echarts 问题记录和解决方案</a>
            
            </h1>
            
        </header>
        <div class="post-content syuanpi riseIn-light back-3">
            
                
                    <h2 id="如何设置-Y-轴两边同时存在刻度，并且允许不同"><a href="#如何设置-Y-轴两边同时存在刻度，并且允许不同" class="headerlink" title="如何设置 Y 轴两边同时存在刻度，并且允许不同"></a>如何设置 Y 轴两边同时存在刻度，并且允许不同</h2><ul>
<li><p>效果如下：<br><img src="media/15210132803835/15210134115793.jpg" alt=""></p>
</li>
<li><p>解决方法：设置给<strong>yAxis</strong>设置成数组，并设置两个，然后在<strong>series</strong>中设置两个元素的<strong>yAxisIndex</strong>指向<strong>yAxis</strong>的目标下标即可。</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">option = &#123;</div><div class="line">    yAxis: [</div><div class="line">        &#123;</div><div class="line">            type: <span class="string">'value'</span>,</div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">            type: <span class="string">'value'</span>,</div><div class="line">        &#125;</div><div class="line">    ],</div><div class="line">    series: [&#123;</div><div class="line">        yAxisIndex:<span class="number">0</span>,</div><div class="line">        data: [<span class="number">0.820</span>, <span class="number">0.932</span>, <span class="number">0.901</span>, <span class="number">0.934</span>, <span class="number">0.1290</span>, <span class="number">0.1330</span>, <span class="number">0.1320</span>],</div><div class="line">        type: <span class="string">'line'</span></div><div class="line">    &#125;,&#123;</div><div class="line">        yAxisIndex:<span class="number">1</span>,</div><div class="line">        data: [<span class="number">820</span>, <span class="number">932</span>, <span class="number">901</span>, <span class="number">934</span>, <span class="number">1290</span>, <span class="number">1330</span>, <span class="number">1320</span>],</div><div class="line">        type: <span class="string">'line'</span></div><div class="line">    &#125;]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="如何设置-Y-轴不存边框线，并且刻度值在刻度线上"><a href="#如何设置-Y-轴不存边框线，并且刻度值在刻度线上" class="headerlink" title="如何设置 Y 轴不存边框线，并且刻度值在刻度线上"></a>如何设置 Y 轴不存边框线，并且刻度值在刻度线上</h2><ul>
<li><p>效果如下：<br><img src="media/15210132803835/15210139637827.jpg" alt=""></p>
</li>
<li><p>解决方法：配置<strong>yAxis</strong>中<strong>yAxis.axisLine.show</strong>属性和<strong>yAxis.axisTick</strong>属性就可以让 Y 轴不显示边框线了，控制刻度值是通过<strong>yAxis.axisLabel</strong>来控制的。</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">option = &#123;</div><div class="line">    yAxis:&#123;</div><div class="line">        type: <span class="string">'value'</span>,</div><div class="line">        axisTick: <span class="literal">false</span>,    <span class="comment">// 控制 Y 轴边框向里突出的那个东西是否显示</span></div><div class="line">        scale: <span class="literal">true</span>,</div><div class="line">        axisLabel: &#123;</div><div class="line">          margin: <span class="number">0</span>,</div><div class="line">          show: <span class="literal">true</span>,</div><div class="line">          inside: <span class="literal">true</span>,</div><div class="line">          color: <span class="string">'#999999'</span>,</div><div class="line">          verticalAlign: <span class="string">'bottom'</span></div><div class="line">        &#125;,</div><div class="line">        axisLine: &#123;         <span class="comment">// 控制 Y 轴边框是否显示</span></div><div class="line">          show: <span class="literal">false</span></div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="如何设置折线图上存在指示图标，并且指示图标样式可以自定义"><a href="#如何设置折线图上存在指示图标，并且指示图标样式可以自定义" class="headerlink" title="如何设置折线图上存在指示图标，并且指示图标样式可以自定义"></a>如何设置折线图上存在指示图标，并且指示图标样式可以自定义</h2><ul>
<li><p>效果如下<br><img src="media/15210132803835/15210146965612.jpg" alt=""></p>
</li>
<li><p>解决方法：设置<strong>markPoint</strong>控制，<strong>markPoint.symbolSize</strong>可以设置指示图标的大小，<strong>markPoint.itemStyle.normal.formatter</strong>可以自定义设置图标内容，通过设置<strong>markPoint.data[i].xAxis</strong>控制图标X轴位置，通过设置<strong>markPoint.data[i].yAxis</strong>控制图标Y轴位置，设置<strong>markPoint.data[i].value</strong>当做<strong>formatter</strong>中param参数的value值，来自定义内容，<strong>itemStyle.normal.color</strong>可以设置指示图标的背景颜色，<strong>label</strong>可以设置目标指示图标的样式和偏移量等。</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">option = &#123;</div><div class="line">  markPoint: &#123;</div><div class="line">    symbolSize: [<span class="number">30</span>, <span class="number">30</span>],</div><div class="line">    itemStyle: &#123;</div><div class="line">      normal: &#123;</div><div class="line">        label: &#123;</div><div class="line">          show: <span class="literal">true</span>,</div><div class="line">          formatter: <span class="function"><span class="keyword">function</span>(<span class="params">param</span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> (param.value == <span class="number">1</span>)</div><div class="line">              <span class="keyword">return</span> <span class="string">'S'</span>;</div><div class="line">            <span class="keyword">else</span></div><div class="line">              <span class="keyword">return</span> <span class="string">'B'</span>;</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    data: [&#123;</div><div class="line">      xAxis: <span class="string">'2012-12-12'</span>,</div><div class="line">      yAxis: <span class="number">30</span>,</div><div class="line">      name: <span class="string">'波峰'</span>,</div><div class="line">      value: <span class="number">0</span>,</div><div class="line">      itemStyle: &#123;</div><div class="line">        normal: &#123;</div><div class="line">          color: <span class="string">'#FEB4B2'</span></div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;, &#123;</div><div class="line">      xAxis: <span class="string">'2012-12-13'</span>,</div><div class="line">      yAxis: <span class="number">40</span>,</div><div class="line">      name: <span class="string">'波谷'</span>,</div><div class="line">      symbolRotate: <span class="number">180</span>,</div><div class="line">      value: <span class="number">1</span>,</div><div class="line">      itemStyle: &#123;</div><div class="line">        normal: &#123;</div><div class="line">          color: <span class="string">'#C1E476'</span></div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      label: &#123;</div><div class="line">        normal: &#123;</div><div class="line">          offset: [<span class="number">0</span>, <span class="number">5</span>]</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="如何精确设置折线图上圆点的数量，并且控制每个点的样式还不一样"><a href="#如何精确设置折线图上圆点的数量，并且控制每个点的样式还不一样" class="headerlink" title="如何精确设置折线图上圆点的数量，并且控制每个点的样式还不一样"></a>如何精确设置折线图上圆点的数量，并且控制每个点的样式还不一样</h2><ul>
<li>效果如下：</li>
</ul>
<p><img src="media/15210132803835/15210155972648.jpg" alt=""></p>
<ul>
<li>解决方法：通过设置<strong>series</strong>中<strong>symbolSize</strong>可以控制小圆圈的大小，通过控制<strong>data</strong>中每一个<strong>value</strong>可以设置 Y 轴的位置，设置<strong>itemStyle</strong>可以控制图上每一个小圆点的样式，<strong>itemStyle.normal.opacity</strong>用来我们控制该圆点是否需要显示（这种方式是因为 X 轴置信只显示了两个坐标刻度，小圆点是根据刻度来的，所以只能显示所有刻度，然后有些隐藏而已），<strong>itemStyle.normal.opacity.borderColor</strong>就可以精确控制每一个小圆点不同样式了。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">option = &#123;</div><div class="line">  series: [&#123;</div><div class="line">    type: <span class="string">'line'</span>,</div><div class="line">    symbolSize: <span class="number">15</span>,</div><div class="line">    data: [&#123;</div><div class="line">      value: <span class="number">820</span>,</div><div class="line">      itemStyle: &#123;</div><div class="line">        normal: &#123;</div><div class="line">          opacity: <span class="number">1</span>, <span class="comment">// 控制是否显示折线上的该点小圆点</span></div><div class="line">          borderColor: <span class="string">'#6C9C39'</span> <span class="comment">// 控制显示某一个折线上该点小圆点的颜色</span></div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;, &#123;</div><div class="line">      value: <span class="number">620</span>,</div><div class="line">      itemStyle: &#123;</div><div class="line">        normal: &#123;</div><div class="line">          opacity: <span class="number">0</span>, <span class="comment">// 控制是否显示折线上的该点小圆点</span></div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;, &#123;</div><div class="line">      value: <span class="number">420</span>,</div><div class="line">      itemStyle: &#123;</div><div class="line">        normal: &#123;</div><div class="line">          opacity: <span class="number">1</span>, <span class="comment">// 控制是否显示折线上的该点小圆点</span></div><div class="line">          borderColor: <span class="string">'#6C9C39'</span> <span class="comment">// 控制显示某一个折线上该点小圆点的颜色</span></div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;, ]</div><div class="line">  &#125;]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="如何精确控制-X-轴的显示刻度有多少个"><a href="#如何精确控制-X-轴的显示刻度有多少个" class="headerlink" title="如何精确控制 X 轴的显示刻度有多少个"></a>如何精确控制 X 轴的显示刻度有多少个</h2><ul>
<li>效果如下：</li>
</ul>
<p><img src="media/15210132803835/15210164719568.jpg" alt=""></p>
<ul>
<li>解决方法：</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">option = &#123;</div><div class="line">  xAxis: &#123;</div><div class="line">    type: <span class="string">'category'</span>,</div><div class="line">    show: <span class="literal">true</span>,</div><div class="line">    splitLine: <span class="literal">false</span>,   <span class="comment">// 不显示X 轴刻度线</span></div><div class="line">    axisLabel: &#123;</div><div class="line">      interval: <span class="number">0</span>, <span class="comment">// 强制控制显示所有的圆点（不会被自动控制）</span></div><div class="line">      padding: [<span class="number">0</span>, <span class="number">60</span>, <span class="number">0</span>, <span class="number">0</span>], <span class="comment">// 控制 X 轴padding值</span></div><div class="line">      color: <span class="string">'#999999'</span>,       <span class="comment">// X 轴刻度值颜色</span></div><div class="line">      formatter: <span class="function"><span class="keyword">function</span>(<span class="params">value, index</span>) </span>&#123; <span class="comment">// 精确控制是否显示刻度值</span></div><div class="line">        <span class="keyword">if</span> (index == <span class="number">0</span> || index == (klineDataLength - <span class="number">1</span>)) &#123;</div><div class="line">          value = value.slice(<span class="number">0</span>, <span class="number">4</span>) + <span class="string">'-'</span> + value.slice(<span class="number">4</span>, <span class="number">6</span>) + <span class="string">'-'</span> + value.slice(<span class="number">6</span>, <span class="number">8</span>);</div><div class="line">          <span class="keyword">if</span> (index === <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">'                                   '</span> + value;</div><div class="line">          &#125;</div><div class="line">          <span class="keyword">return</span> value;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="string">''</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    data: [<span class="string">'20121212'</span>, <span class="string">'20121213'</span>, <span class="string">'20121214'</span>, <span class="string">'20121215'</span>, <span class="string">'20121216'</span>]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="如何给图表设置指示线"><a href="#如何给图表设置指示线" class="headerlink" title="如何给图表设置指示线"></a>如何给图表设置指示线</h2><ul>
<li>效果如下：</li>
</ul>
<p><img src="media/15210132803835/15210168619095.jpg" alt=""></p>
<ul>
<li>解决方法：</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">option = &#123;</div><div class="line">  series: [&#123;</div><div class="line">    type: <span class="string">'line'</span>,</div><div class="line">    markLine: &#123;</div><div class="line">      symbol: [<span class="string">'none'</span>, <span class="string">'none'</span>],</div><div class="line">      label: &#123;</div><div class="line">        normal: &#123;</div><div class="line">          position: <span class="string">'middle'</span>  <span class="comment">// 统一设置线上名称的位置</span></div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      data: [&#123;  <span class="comment">// 设置线的条数</span></div><div class="line">          yAxis: <span class="number">20</span>,</div><div class="line">          lineStyle: &#123;  <span class="comment">// 设置线的样式</span></div><div class="line">            normal: &#123;</div><div class="line">              type: <span class="string">'solid'</span>,</div><div class="line">              color: <span class="string">'#FF5B5C'</span></div><div class="line">            &#125;</div><div class="line">          &#125;,</div><div class="line">          label: &#123;      <span class="comment">// 设置线上名称和其样式</span></div><div class="line">            show: <span class="literal">true</span>,</div><div class="line">            normal: &#123;</div><div class="line">              formatter: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                <span class="keyword">return</span> <span class="string">'过热'</span></div><div class="line">              &#125;</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">        &#125;, &#123;</div><div class="line">          yAxis: <span class="number">30</span>,</div><div class="line">          lineStyle: &#123;</div><div class="line">            normal: &#123;</div><div class="line">              type: <span class="string">'solid'</span>,</div><div class="line">              color: <span class="string">'#6BACFC'</span></div><div class="line">            &#125;</div><div class="line">          &#125;,</div><div class="line">          label: &#123;</div><div class="line">            show: <span class="literal">true</span>,</div><div class="line">            normal: &#123;</div><div class="line">              formatter: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">                <span class="keyword">return</span> <span class="string">'过冷'</span></div><div class="line">              &#125;</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="如何设置图表内容全部展示的同时自适应布局"><a href="#如何设置图表内容全部展示的同时自适应布局" class="headerlink" title="如何设置图表内容全部展示的同时自适应布局"></a>如何设置图表内容全部展示的同时自适应布局</h2><ul>
<li>解决方法：</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">option = &#123;</div><div class="line">  grid: &#123;</div><div class="line">    top: <span class="number">20</span>,</div><div class="line">    bottom: <span class="number">10</span>,</div><div class="line">    left: <span class="number">0</span>,</div><div class="line">    right: <span class="number">5</span>,</div><div class="line">    containLabel: <span class="literal">true</span>, <span class="comment">// 当设置为true时会把所有的内容的包含进去再自适应布局布局</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

                
            
        
        </div>
        
    </article>
    

    
        
    <article class="post">
        <header class="post-header">
            <div class="post-time syuanpi riseIn-light back-1">
                <span>2017年8月22日</span>
                
            </div>
            <h1 class="post-title syuanpi riseIn-light back-2">
            
                <a href="/2017/08/22/理解CSS中的层叠上下文和层叠顺序/">理解CSS中的层叠上下文和层叠顺序</a>
            
            </h1>
            
        </header>
        <div class="post-content syuanpi riseIn-light back-3">
            
                
                    <h2 id="什么是层叠上下文（stacking-context）"><a href="#什么是层叠上下文（stacking-context）" class="headerlink" title="什么是层叠上下文（stacking context）"></a>什么是层叠上下文（stacking context）</h2><ul>
<li>可以理解为一个dom节点在Z轴高人一等，特性类似于<strong>BFC</strong>，即层叠上下文的内部子元素再怎么翻江倒海，翻云覆雨都不会影响外部的元素。</li>
</ul>
<h2 id="CSS2创建层叠上下文的两种方法（参考MDN）"><a href="#CSS2创建层叠上下文的两种方法（参考MDN）" class="headerlink" title="CSS2创建层叠上下文的两种方法（参考MDN）"></a>CSS2创建层叠上下文的两种方法（参考MDN）</h2><ul>
<li>根元素 (HTML)</li>
<li>绝对（absolute）定位或相对（relative）定位且 z-index 值不为”auto”</li>
</ul>
<h2 id="CSS3新增的8种方法（参考MDN）"><a href="#CSS3新增的8种方法（参考MDN）" class="headerlink" title="CSS3新增的8种方法（参考MDN）"></a>CSS3新增的8种方法（参考MDN）</h2><ul>
<li>一个 flex 元素(flex item)，且 z-index 值不为 “auto”，也就是父元素 display: flex|inline-flex</li>
<li>元素的 opacity 属性值小于 1（参考：<a href="https://www.w3.org/TR/css3-color/#transparency" target="_blank" rel="external">the specification for opacity</a>）</li>
<li>元素的 transform 属性值不为 “none”</li>
<li>元素的 mix-blend-mode 属性值不为 “normal”</li>
<li>元素的 isolation 属性被设置为 “isolate”</li>
<li>在 mobile WebKit 和 Chrome 22+ 内核的浏览器中，position: fixed 总是创建一个新的层叠上下文, 即使 z-index 的值是 “auto”</li>
<li>在 will-change 中指定了任意 CSS 属性，即便你没有定义该元素的这些属性（参考：<a href="https://dev.opera.com/articles/css-will-change-property/" target="_blank" rel="external">Everything You Need to Know About the CSS will-change Property</a>）</li>
<li>元素的 -webkit-overflow-scrolling 属性被设置 “touch”</li>
</ul>
<h2 id="什么是层叠水平（stacking-level）"><a href="#什么是层叠水平（stacking-level）" class="headerlink" title="什么是层叠水平（stacking level）"></a>什么是层叠水平（stacking level）</h2><ul>
<li>层叠水平决定了<strong>同一个层叠上下文中元素在z轴上的显示顺序（层叠顺序）</strong>，也就是说普通元素的层叠水平优先由层叠上下文决定。</li>
</ul>
<h2 id="层叠顺序（不包含CSS3属性）"><a href="#层叠顺序（不包含CSS3属性）" class="headerlink" title="层叠顺序（不包含CSS3属性）"></a>层叠顺序（不包含CSS3属性）</h2><p><img src="http://www.w3help.org/zh-cn/kb/013/stacklevel.png" alt=""></p>
<h6 id="注意：以上只适用于同一个层级上下文"><a href="#注意：以上只适用于同一个层级上下文" class="headerlink" title="注意：以上只适用于同一个层级上下文"></a>注意：以上只适用于同一个层级上下文</h6><h2 id="层叠顺序的例子"><a href="#层叠顺序的例子" class="headerlink" title="层叠顺序的例子"></a>层叠顺序的例子</h2><p><a href="https://repl.it/NcWU/4" target="_blank" rel="external">CSS2层叠上下文的层叠顺序demo</a><br><img src="media/15095911824790/15096064713504.jpg" alt=""></p>
<h2 id="创建层叠上下文的opacity影响层叠顺序的例子"><a href="#创建层叠上下文的opacity影响层叠顺序的例子" class="headerlink" title="创建层叠上下文的opacity影响层叠顺序的例子"></a>创建层叠上下文的opacity影响层叠顺序的例子</h2><p><a href="https://repl.it/Nc1n/4" target="_blank" rel="external">验证css中opacity创建层叠上下文影响的层叠顺序demo</a><br><img src="media/15095911824790/15096096002490.jpg" alt=""></p>
<h2 id="层叠准则"><a href="#层叠准则" class="headerlink" title="层叠准则"></a>层叠准则</h2><ul>
<li><strong>谁大谁上：</strong>当具有明显的层叠水平标识（即上面那幅层叠顺序图）的时候，在同一个层叠上下文内，层叠水平值大的那一个覆盖小的那一个。</li>
<li><strong>后来居上：</strong>当元素的层叠水平一致、层叠顺序相同的时候，在DOM流中处于后面的元素会覆盖前面的元素。</li>
</ul>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><ul>
<li>属于同一层叠上下文的元素（无论它们在结构上是兄弟或父子，甚至是祖孙），都遵循上文所述的层叠顺序；</li>
<li>不同的层叠上下文之间，层级较大的层叠上下文元素及其内部元素位于层级小的层叠上下文元素及其内部元素之上；</li>
<li>不同的层叠上下文之间互相独立；</li>
<li>层叠上下文可嵌套，内部规则不影响外部。</li>
</ul>
<h2 id="相关连接"><a href="#相关连接" class="headerlink" title="相关连接"></a>相关连接</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Understanding_z_index/The_stacking_context" target="_blank" rel="external">MDN：The stacking context</a><br><a href="http://www.zhangxinxu.com/wordpress/2016/01/understand-css-stacking-context-order-z-index/" target="_blank" rel="external">深入理解CSS中的层叠上下文和层叠顺序</a><br><a href="https://aotu.io/notes/2015/11/08/css-stack-order/index.html" target="_blank" rel="external">css层叠顺序探究</a><br><a href="http://www.w3help.org/zh-cn/kb/013" target="_blank" rel="external">分层的显示</a></p>

                
            
        
        </div>
        
    </article>
    

    
        
    <article class="post">
        <header class="post-header">
            <div class="post-time syuanpi riseIn-light back-1">
                <span>2017年8月22日</span>
                
            </div>
            <h1 class="post-title syuanpi riseIn-light back-2">
            
                <a href="/2017/08/22/闭包的副本/">JS实现一个scroll自定义滚动效果</a>
            
            </h1>
            
        </header>
        <div class="post-content syuanpi riseIn-light back-3">
            
                
                    <p>在公司开发项目的时候，原生滚动条中有些东西没办法自定义去精细的控制，于是开发一个类似于better-scroll一样的浏览器滚动监听的JS实现，下面我们就来探究一下自定义滚动需要考虑哪些东西，经过哪些过程。</p>
<p>##选择滚动监听的事件<br>因为是自定义手机端的滚动事件，那我选择的是监听手机端的三个touch事件来实现监听，并实现了两种滚动效果，一种是通过-webkit-transform，一种是通过top属性。两种实现对于滚动的基本效果够能达到，可是top的不适合滚动中还存在滚动，可是能解决滚动中存在postion:fixed属性的问题；而transform可以实现滚动中有滚动，可是又不能解决postion:fixed的问题，所以，最后选择性考虑使用哪一种实现方式，用法一样。</p>
<p>##主要的实现业务逻辑</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">handleTouchMove(event)&#123;</div><div class="line">    event.preventDefault();</div><div class="line">    <span class="keyword">this</span>.currentY = event.targetTouches[<span class="number">0</span>].screenY;</div><div class="line">    <span class="keyword">this</span>.currentTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</div><div class="line">    <span class="comment">// 二次及以上次数滚动（间歇性滚动）时间和路程重置计算，0.05是间歇性滚动的停顿位移和时间比</span></div><div class="line">    <span class="keyword">if</span> (<span class="built_in">Math</span>.abs(<span class="keyword">this</span>.currentY - <span class="keyword">this</span>.lastY) / <span class="built_in">Math</span>.abs(<span class="keyword">this</span>.currentTime - <span class="keyword">this</span>.lastTime) &lt; <span class="number">0.05</span>) &#123;</div><div class="line">        <span class="keyword">this</span>.startTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</div><div class="line">        <span class="keyword">this</span>.resetY = <span class="keyword">this</span>.currentY;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">this</span>.distance = <span class="keyword">this</span>.currentY - <span class="keyword">this</span>.startY;</div><div class="line">    <span class="keyword">let</span> temDis = <span class="keyword">this</span>.distance + <span class="keyword">this</span>.oldY;</div><div class="line">    <span class="comment">/*设置移动最小值*/</span></div><div class="line">    temDis = temDis &gt; <span class="keyword">this</span>.minValue ? temDis * <span class="number">1</span> / <span class="number">3</span> : temDis;</div><div class="line">    <span class="comment">/*设置移动最大值*/</span></div><div class="line">    temDis = temDis &lt; -<span class="keyword">this</span>.maxValue ? -<span class="keyword">this</span>.maxValue + (temDis + <span class="keyword">this</span>.maxValue) * <span class="number">1</span> / <span class="number">3</span> : temDis;</div><div class="line">    <span class="keyword">this</span>.$el.style[<span class="string">"top"</span>] = temDis + <span class="string">'px'</span>;</div><div class="line">    <span class="keyword">this</span>.lastY = <span class="keyword">this</span>.currentY;</div><div class="line">    <span class="keyword">this</span>.lastTime = <span class="keyword">this</span>.currentTime;</div><div class="line">    <span class="keyword">this</span>.dispatchEvent();</div><div class="line">    <span class="keyword">this</span>.scrollFunc(event);</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<p><strong>代码解读：</strong>这是监听touchmove事件的回调，其中主要计算出目标节点<strong>this.$el</strong>的<strong>top</strong>或者-webkit-transform中<strong>translateY</strong>的值，而计算的参考主要以事件节点的screenY的垂直移动距离为参考，当然其中还要判断一下最大值和最小值，为了保证移动可以的超出最大值小值一定的距离所以加了一个<strong>1/3</strong>的移动计算。这里可能主要到了有一个<strong>间歇性滚动</strong>的判断和计算，主要是服务于<strong>惯性滚动</strong>的，目的是让惯性滚动的值更加精确。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">handleTouchEnd(event)&#123;</div><div class="line">    <span class="comment">/*点透事件允许通过*/</span></div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.distance) <span class="keyword">return</span>;</div><div class="line">    event.preventDefault();</div><div class="line">    <span class="keyword">let</span> temDis = <span class="keyword">this</span>.distance + <span class="keyword">this</span>.oldY;</div><div class="line">    <span class="comment">/*计算缓动值*/</span></div><div class="line">    temDis = <span class="keyword">this</span>.computeSlowMotion(temDis);</div><div class="line">    <span class="comment">/*设置最小值*/</span></div><div class="line">    temDis = temDis &gt; <span class="keyword">this</span>.minValue ? <span class="keyword">this</span>.minValue : temDis;</div><div class="line">    <span class="comment">/*设置最大值*/</span></div><div class="line">    temDis = temDis &lt; -<span class="keyword">this</span>.maxValue ? -<span class="keyword">this</span>.maxValue : temDis;</div><div class="line">    <span class="keyword">this</span>.$el.style[<span class="string">"transitionDuration"</span>] = <span class="string">'500ms'</span>;</div><div class="line">    <span class="keyword">this</span>.$el.style[<span class="string">"transitionTimingFunction"</span>] = <span class="string">'ease-out'</span>;</div><div class="line">    <span class="comment">/*确定最终的滚动位置*/</span></div><div class="line">    setTimeout(<span class="function"><span class="params">()</span>=&gt;</span> &#123;</div><div class="line">        <span class="keyword">this</span>.$el.style[<span class="string">"top"</span>] = temDis + <span class="string">'px'</span>;</div><div class="line">    &#125;, <span class="number">0</span>);</div><div class="line">    <span class="comment">// 判断使用哪一种监听事件</span></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.slowMotionFlag) &#123;</div><div class="line">        <span class="keyword">this</span>.dispatchEventLoop();</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">this</span>.dispatchEvent();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">this</span>.$el.addEventListener(<span class="string">'transitionend'</span>, ()=&gt; &#123;</div><div class="line">        <span class="built_in">window</span>.cancelAnimationFrame(<span class="keyword">this</span>.timer);</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">this</span>.scrollFunc(event);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>代码解读：</strong>这是touchend事件监听的回调，其中这里要判断是否要拦截click和tap事件，并且这里还要计算<strong>惯性缓动值</strong>，设置最终的最大最小值，以及设置动画效果和缓动效果。下面来谈一下滚性滚动的计算：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 计算惯性滚动值</span></div><div class="line">computeSlowMotion(temDis)&#123;</div><div class="line">    <span class="keyword">var</span> duration = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime() - <span class="keyword">this</span>.startTime;</div><div class="line">    <span class="comment">// 300毫秒是判断间隔的最佳时间</span></div><div class="line">    <span class="keyword">var</span> resetDistance = <span class="keyword">this</span>.currentY - <span class="keyword">this</span>.resetY;</div><div class="line">    <span class="keyword">if</span> (duration &lt; <span class="number">300</span> &amp;&amp; <span class="built_in">Math</span>.abs(resetDistance) &gt; <span class="number">10</span>) &#123;</div><div class="line">        <span class="keyword">var</span> speed = <span class="built_in">Math</span>.abs(resetDistance) / duration,</div><div class="line">            destination;</div><div class="line">        <span class="comment">// 末速度为0 距离等于初速度的平方除以2倍加速度</span></div><div class="line">        destination = (speed * speed) / (<span class="number">2</span> * <span class="keyword">this</span>.deceleration) * (resetDistance &lt; <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">1</span>);</div><div class="line">        <span class="keyword">this</span>.slowMotionFlag = <span class="literal">true</span>;</div><div class="line">        <span class="keyword">return</span> temDis += destination;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">this</span>.slowMotionFlag = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">return</span> temDis;</div><div class="line">    &#125;</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<p><strong>代码解读</strong>：滚性滚动的算法主要是根据一个路程和时间计算出初速度，以及原生滚动的加速度的大于值0.006来计算滚动的总位移。这里主要还要判断一下一个300ms的经验值。</p>
<p>##总结<br>大概的流程和思考就是这样了，后续还会增加更多的功能进行扩展，下面附上git地址：<a href="https://github.com/yejiaming/scroll" target="_blank" rel="external">https://github.com/yejiaming/scroll</a></p>

                
            
        
        </div>
        
    </article>
    

    
        
    <article class="post">
        <header class="post-header">
            <div class="post-time syuanpi riseIn-light back-1">
                <span>2017年8月22日</span>
                
            </div>
            <h1 class="post-title syuanpi riseIn-light back-2">
            
                <a href="/2017/08/22/ES5和ES6作用域/">ES5和ES6作用域</a>
            
            </h1>
            
        </header>
        <div class="post-content syuanpi riseIn-light back-3">
            
                
                    <h1 id="ES5和ES6作用域"><a href="#ES5和ES6作用域" class="headerlink" title="ES5和ES6作用域"></a>ES5和ES6作用域</h1><p>##ES5的块级作用域</p>
<p>####ES5的块级作用域是一个伪块级作用域，代码块：{}，它的块里面和块外面都是共用一个作用域，即：<br><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	<span class="keyword">var</span> a =<span class="number">3</span>;</div><div class="line">	<span class="built_in">console</span>.log(a); <span class="comment">//结果为3   </span></div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(a); <span class="comment">//结果为3</span></div></pre></td></tr></table></figure>
<p><strong>Example:</strong><br>ES5的伪块级作用域另外一个典型的例子如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [];</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</div><div class="line">	a.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">		<span class="built_in">console</span>.log(i);</div><div class="line">	&#125;);</div><div class="line">&#125;</div><div class="line">a[<span class="number">0</span>](); <span class="comment">//预期结果是0，实际结果是10</span></div></pre></td></tr></table></figure>
<p><strong><em>注意</em></strong>：出现上述现象的主要原因是使用var定义的变量 <em>i</em> 是一个全局变量，导致真正在调用的时候虽然循环了10次，可是最终十次都是只修改了全局变量 <em>i</em> ,并没有区分出私有作用域。与之相反的两个例子如下：<br>
                    
            
        
            <p class="content-link">
                <a href="/2017/08/22/ES5和ES6作用域/#more">
                    <span class="iconfont icon-right">继续阅读</span>
                </a>
            </p>
        
        </div>
        
    </article>
    

    
        
    <article class="post">
        <header class="post-header">
            <div class="post-time syuanpi riseIn-light back-1">
                <span>2017年8月21日</span>
                
            </div>
            <h1 class="post-title syuanpi riseIn-light back-2">
            
                <a href="/2017/08/21/对ES5中apply、call和bind三个方法的解读/">对ES5中apply、call和bind三个方法的解读</a>
            
            </h1>
            
        </header>
        <div class="post-content syuanpi riseIn-light back-3">
            
                
                    <h1 id="ES6迭代器（interator）和for…of…循环"><a href="#ES6迭代器（interator）和for…of…循环" class="headerlink" title="ES6迭代器（interator）和for…of…循环"></a>ES6迭代器（interator）和for…of…循环</h1><p>或许在写ES6的代码的时候，你可能没有感觉有用过迭代器这个东西，可是ES6中的for…of…循环我们都不陌生，而for…of…循环的必要条件就是必须满足被循环的对象实现了迭代器接口才行。例子如下：</p>
<p><strong>Example</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> b = &#123;</div><div class="line">		name:<span class="string">'arvin'</span>,</div><div class="line">		age:<span class="number">30</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">of</span> a)&#123;</div><div class="line">		<span class="built_in">console</span>.log(i);     <span class="comment">// 结果依次是：1，2，3</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> j <span class="keyword">of</span> b)&#123;</div><div class="line">		<span class="built_in">console</span>.log(j);     <span class="comment">// TypeError: b[Symbol.iterator] is not a function</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
                    
            
        
            <p class="content-link">
                <a href="/2017/08/21/对ES5中apply、call和bind三个方法的解读/#more">
                    <span class="iconfont icon-right">继续阅读</span>
                </a>
            </p>
        
        </div>
        
    </article>
    

    
</section>
    
    <nav class="pagination">
        <a class="extend prev" rel="prev" href="/page/2/">< 上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
    </nav>


        </main>
        <footer class="footer syuanpi fadeIn" id="footer">
    <hr>
    <div class="footer-wrapper">
        <div class="left">
            <div class="contact-icon">
    
    
    
    
    
    
    
    
        
            <a href="https://github.com/yejiaming" class="iconfont icon-github" title="github"></a>
        
        
        
        
        
        
        
    
</div>
        </div>
        <div class="right">
            <div class="copyright">
    <div class="info">
        <span>&copy;</span>
        <span>2017 ~ 2018</span>
        <span>❤</span>
        <span>arvin ye</span>
    </div>
    <div class="theme">
        <span>
            动力来源于
            <a href="http://hexo.io/" target="_blank">Hexo </a>
        </span>
        <span>
            主题
            <a href="https://github.com/ColMugX/hexo-theme-Nlvi"> Nlvi </a>
        </span>
    </div>
    
    <div class="visit_count">
        <i class="iconfont icon-visit"></i>
        <span id="busuanzi_value_site_uv"></span>
        <i class="iconfont icon-people"></i>
        <span id="busuanzi_value_site_pv"></span>
    </div>
    
</div>
        </div>
    </div>
</footer>
    </div>
    <script src="/script/nlvi.js"></script>
<script src="/script/search.js"></script>

    <script src="/lightbox/js/lightbox.min.js"></script>

<script>
$(document).ready(function(){
    document.body.addEventListener('touchstart', function () {});
    $('.progress').hide();
    $('.body').show();
    Nlvi.tagcloud();
    Nlvi.mobileHeader();
    Nlvi.back2top();
    Nlvi.smoothScroll();
    Nlvi.onView();
    Nlvi.showToc();
    Nlvi.showComments();
    Nlvi.showReward();

    !CONFIG.animate && Nlvi.offAnimate();
    CONFIG.lightbox && Nlvi.onPicBox();
})
</script>
    </div>
    
    <div class="backtop syuanpi dead toTop" id="backtop">
    <i class="iconfont icon-up"></i>
    <span style="text-align:center;font-family:Georgia;"><span style="font-family:Georgia;" id="scrollpercent">1</span>%</span>
</div>
    
    <div class="search" id="search">
        <div class="mask" id="mask"></div>
        <div class="search-wrapper syuanpi">
            <h1 id="search-header" class="syuanpi">搜索一下？</h1>
            <div class="input">
                <input type="text" id="local-search-input" results="0" name="">
            </div>
            <div id="local-search-result"></div>
        </div>
    </div>
    <script>
    var GREETING = {
        morning: "当我们探索时，就要发现到真理",
        noon: "人的天职在于勇于探索真理。",
        after: "一件事实是一条没有性别的真理",
        night: "真理有时可能变得黯淡，但它永远不会熄灭",
        midnight: "真理在人那里获得生命力，并且展现出来"
    }
    $(document).ready(function(){
        Nlvi.search();
    });
    </script>

</body>
</html>
